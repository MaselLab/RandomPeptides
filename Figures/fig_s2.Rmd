---
title: "Supplemental Figure S2"
author: "Luke Kosinski"
date: "February 26, 2022"
output: html_document
---

Load data and packages.

```{r}
library(tidyverse)
library(Hmisc)

peptide.data <- read.table(file = "../Data/supplemental_dataset_1.tsv", header = T, stringsAsFactors = F)
```

Grouping by cluster and plotting fitness vs weight.

```{r}
peptide_cluster <- peptide.data %>% group_by(Cluster) %>% summarise(
  Fitness = wtd.mean(FITNESS, weights = WEIGHT),
  Weight = sum(WEIGHT)
)

cor(peptide_cluster$Fitness, peptide_cluster$Weight)

peptide_cluster %>% ggplot(
  data = .,
  aes(
    x = Fitness,
    y = Weight
  )
) + geom_point() + geom_smooth() + theme_bw(base_size = 24)

# Log weights for the updated fitness estimates are missing.
```

