(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48165,       1178]
NotebookOptionsPosition[     44999,       1104]
NotebookOutlinePosition[     45341,       1119]
CellTagsIndexPosition[     45298,       1116]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"X", " ", "=", 
   RowBox[{"Import", "[", "\"\<...\\\\PeptideDataOut.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.746472518315283*^9, 3.7464725194486294`*^9}, 
   3.7528672815191417`*^9, 3.764964257266086*^9, {3.795815354644673*^9, 
   3.795815356324256*^9}},ExpressionUUID->"1cad163b-f300-4d46-a630-\
728ce220a535"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NEME", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<...\\\\SeqAny.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NemFindID", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NEME", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
        RowBox[{
         RowBox[{"NEME", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "Nothing"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "NEME", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PEPID", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<...\\\\PEPIDS.tsv\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7625415232777*^9, 3.762541538597865*^9}, 
   3.7625416518556385`*^9, {3.7625420201772084`*^9, 3.762542020832845*^9}, {
   3.7625433182619343`*^9, 3.762543320875429*^9}, {3.795815364826516*^9, 
   3.7958153919239054`*^9}},ExpressionUUID->"de248237-a6b0-4314-b2d2-\
fc92d8efe3fb"],

Cell[BoxData[
 RowBox[{"PEPID", ";"}]], "Input",
 CellChangeTimes->{{3.7613334977896004`*^9, 3.761333500965766*^9}, 
   3.762286857035568*^9},ExpressionUUID->"f3a88a09-66cc-4b52-8d37-\
6a8fda17080d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "X", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xdata", " ", "=", " ", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{"d", "-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nt", " ", "=", " ", 
   RowBox[{"X", "[", 
    RowBox[{"[", "d", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Xdata", ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7528672939161263`*^9, 3.7528673760065837`*^9}, {
  3.7528678667467785`*^9, 3.7528678737077*^9}, {3.756149529613902*^9, 
  3.7561495727680163`*^9}, {3.756653424422979*^9, 3.756653428904393*^9}, {
  3.7568424813182163`*^9, 3.7568425277426167`*^9}, {3.7568432959386063`*^9, 
  3.7568433196649466`*^9}, {3.757860556313422*^9, 3.757860599565548*^9}, {
  3.757860661542904*^9, 3.7578606786720533`*^9}, {3.759515392146488*^9, 
  3.7595154499088955`*^9}, {3.759516056007722*^9, 
  3.7595160697875447`*^9}},ExpressionUUID->"d0adb89c-15a0-4014-8a18-\
920a137812ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Xdata", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.76038654138655*^9, 
  3.760386547089507*^9}},ExpressionUUID->"ca0cc706-fbc7-4a28-9886-\
3bafa14c19cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2015", ",", "3292", ",", "3719", ",", "4835"}], "}"}]], "Output",
 CellChangeTimes->{
  3.760386547707221*^9, 3.762286853099833*^9, 3.7625420460992937`*^9, 
   3.7626307670863743`*^9, 3.76263502177637*^9, {3.7649642370037384`*^9, 
   3.7649642636773996`*^9}, 
   3.764964307251338*^9},ExpressionUUID->"b70423bd-a814-4097-8b7e-\
87eba345b929"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FitListIn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "1061"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PioListIn", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "1061"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PooledList", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "1061"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MFCest", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FitSeq", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "1061"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ErrorCheck", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7595179060870733`*^9, 3.759517958980688*^9}, 
   3.7595223013895097`*^9, {3.7595354961277*^9, 3.7595355129930005`*^9}, {
   3.7596093565740147`*^9, 3.7596093855183687`*^9}, {3.7596965812183924`*^9, 
   3.759696600129855*^9}, 3.760130808017314*^9, {3.7601320768068113`*^9, 
   3.760132089857321*^9}, 3.7603889266743803`*^9, {3.7603889671434965`*^9, 
   3.7603889673285913`*^9}, {3.7658164755300727`*^9, 3.765816491860236*^9}, {
   3.795815599978711*^9, 
   3.795815600367703*^9}},ExpressionUUID->"31b0b418-f019-4381-8cf9-\
33c565c42f28"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProdMeanFIT", "[", 
    RowBox[{"MFCest_", ",", "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{
    UnderoverscriptBox["\[Product]", 
     RowBox[{"k", "=", "1"}], "t"], 
    RowBox[{"MFCest", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7595196778273034`*^9, 3.759519680768634*^9}, {
  3.7595198430265603`*^9, 3.7595198689366517`*^9}, {3.795815602589279*^9, 
  3.7958156027877483`*^9}},ExpressionUUID->"f7371659-3ca6-4b1b-9b00-\
87578c2bfd55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolvePio", "[", 
   RowBox[{"\[Omega]_", ",", "nit_", ",", "Nt_", ",", "MFCest_"}], "]"}], " ",
   ":=", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
  FractionBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"t", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"nit", "[", 
      RowBox[{"[", "t", "]"}], "]"}], "*", "t"}]}], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"t", "=", "1"}], "4"], 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Nt", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", 
        SuperscriptBox["\[Omega]", "t"]}], ")"}], "*", "t"}], 
     RowBox[{"ProdMeanFIT", "[", 
      RowBox[{"MFCest", ",", "t"}], "]"}]]}]]}]], "Input",
 CellChangeTimes->{{3.7595295999400463`*^9, 3.759529602539552*^9}, {
   3.7595308640025396`*^9, 3.75953100430061*^9}, {3.7595312938975143`*^9, 
   3.759531295572378*^9}, {3.759531964929509*^9, 3.7595319780449667`*^9}, {
   3.7595320272441893`*^9, 3.759532028565429*^9}, {3.759532300964507*^9, 
   3.759532302419671*^9}, {3.7595324700095744`*^9, 3.7595324751307473`*^9}, {
   3.7595326110376873`*^9, 3.7595326505442395`*^9}, 3.759532700739789*^9, {
   3.7595327759907084`*^9, 3.7595328157468004`*^9}, {3.759786019331868*^9, 
   3.7597860253564043`*^9}, 
   3.7958156066639347`*^9},ExpressionUUID->"ff661cdd-6307-4ca2-b230-\
d0fd0c600cc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyFitCoe", "[", 
   RowBox[{"nit_", ",", "Nt_", ",", "MFCest_", ",", "t_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{"(", 
    FractionBox[
     RowBox[{"Nt", "[", 
      RowBox[{"[", "t", "]"}], "]"}], 
     RowBox[{"ProdMeanFIT", "[", 
      RowBox[{"MFCest", ",", "t"}], "]"}]], ")"}], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "1"}], "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nit", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"t", "-", "k"}], ")"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7595205050485*^9, 3.7595205080967464`*^9}, {
  3.7595205672356997`*^9, 
  3.7595205711084723`*^9}},ExpressionUUID->"6a6d5593-9327-4a97-a42e-\
a7741b5e85df"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PolySolveFIT", "[", 
     RowBox[{"nit_", ",", "Nt_", ",", "MFCest_"}], "]"}], ":=", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "Ct"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ct", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Ct", "[", 
           RowBox[{"[", "k", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"PolyFitCoe", "[", 
           RowBox[{"nit", ",", "Nt", ",", "MFCest", ",", "k"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "1"}], "4"], 
            RowBox[{
             RowBox[{"Ct", "[", 
              RowBox[{"[", "k", "]"}], "]"}], 
             SuperscriptBox["\[Omega]", 
              RowBox[{"(", 
               RowBox[{"k", "-", "1"}], ")"}]]}]}], " ", "\[Equal]", " ", 
           "0"}], ",", "\[Omega]", ",", " ", "Reals"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7595195228517065`*^9, 3.759519549238738*^9}, {
  3.7595196890898485`*^9, 3.759519693256452*^9}, {3.759519872038868*^9, 
  3.7595198810262437`*^9}, {3.759519922651049*^9, 3.7595199432076607`*^9}, {
  3.7595201783075523`*^9, 3.7595201998081975`*^9}, {3.759521095426446*^9, 
  3.7595211879890127`*^9}, {3.7595212320310183`*^9, 3.759521254983802*^9}, {
  3.7595213345398545`*^9, 3.759521340185603*^9}, {3.759521393512641*^9, 
  3.7595213947499285`*^9}, {3.7595214634872065`*^9, 3.7595214887496643`*^9}, {
  3.7595215428573575`*^9, 3.759521566888403*^9}, {3.7595220903044753`*^9, 
  3.759522151288249*^9}, {3.7595221895599966`*^9, 
  3.759522208378885*^9}},ExpressionUUID->"240659e6-ede1-4842-a498-\
a18153d1a4fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LikelihoodTuple", "[", 
   RowBox[{"\[Omega]_", ",", "nit_", ",", "Nt_", ",", "MFCest_"}], "]"}], " ",
   ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "t", ",", "k", ",", "kpio", ",", "p", ",", " ", "likeList", 
      ",", "bestCheck"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"likeList", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Omega]", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"kpio", " ", "=", " ", 
         RowBox[{"SolvePio", "[", 
          RowBox[{
           RowBox[{"\[Omega]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "nit", ",", "Nt", ",", 
           "MFCest"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"likeList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"t", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"nit", "[", 
              RowBox[{"[", "t", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", "kpio", "]"}], "+", 
               RowBox[{"t", "*", 
                RowBox[{"Log", "[", 
                 RowBox[{"\[Omega]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{"Log", "[", 
                RowBox[{"ProdMeanFIT", "[", 
                 RowBox[{"MFCest", ",", "t"}], "]"}], "]"}]}], ")"}]}], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"Nt", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "*", "kpio", "*", 
              SuperscriptBox[
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " "}], "t"]}], 
             RowBox[{"ProdMeanFIT", "[", 
              RowBox[{"MFCest", ",", "t"}], "]"}]]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Omega]", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nit", " ", "\[Equal]", " ", 
        RowBox[{"{", 
         RowBox[{"2015", ",", "3292", ",", "3719", ",", "4835"}], "}"}]}], 
       ",", 
       RowBox[{"Print", "[", "likeList", "]"}], ",", "Nothing"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"likeList", ",", 
         RowBox[{"Max", "[", "likeList", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bestCheck", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "p", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "kpio"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "bestCheck", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.759524934681239*^9, 3.7595249349181023`*^9}, {
   3.7595274259249916`*^9, 3.759527458338363*^9}, {3.759527811051829*^9, 
   3.75952795439209*^9}, {3.759528096363202*^9, 3.759528139861492*^9}, {
   3.7595282260905666`*^9, 3.7595282441171827`*^9}, {3.759528364290083*^9, 
   3.759528387908677*^9}, {3.759528461461055*^9, 3.759528525420732*^9}, {
   3.759528580932865*^9, 3.759528593905719*^9}, {3.759528746883042*^9, 
   3.759528874807822*^9}, {3.759528980633176*^9, 3.7595289833726006`*^9}, {
   3.759529015216965*^9, 3.759529039442034*^9}, 3.7595292067829123`*^9, {
   3.759529256285158*^9, 3.759529297507921*^9}, {3.759529327679311*^9, 
   3.7595293499207687`*^9}, {3.759529444536499*^9, 3.75952946216953*^9}, {
   3.7595295264003034`*^9, 3.7595295278304806`*^9}, {3.7595304090751505`*^9, 
   3.7595304137124834`*^9}, {3.7595306133132334`*^9, 3.759530615815332*^9}, {
   3.7595307318948555`*^9, 3.759530734974084*^9}, {3.7595307941191425`*^9, 
   3.759530819877347*^9}, {3.7595313903196507`*^9, 3.759531410304158*^9}, {
   3.7595314683176565`*^9, 3.7595315717725587`*^9}, {3.759531619118619*^9, 
   3.759531630238234*^9}, 3.7595316618137646`*^9, {3.7595317078251104`*^9, 
   3.759531833940625*^9}, {3.759532551421588*^9, 3.7595325535433664`*^9}, {
   3.7595328595464387`*^9, 3.7595330152180176`*^9}, {3.759533051590556*^9, 
   3.759533052677931*^9}, {3.7595332341121335`*^9, 3.759533239455552*^9}, {
   3.7595332736725764`*^9, 3.7595332855311255`*^9}, {3.759533399373857*^9, 
   3.759533401652413*^9}, {3.7595335059562893`*^9, 3.75953354741253*^9}, {
   3.759533582342207*^9, 3.759533592152566*^9}, {3.7595336400889015`*^9, 
   3.759533641359706*^9}, {3.7595336745736256`*^9, 3.759533675532075*^9}, {
   3.759533914913951*^9, 3.7595339153926754`*^9}, {3.7595345078939486`*^9, 
   3.7595345299122853`*^9}, {3.7595345711812983`*^9, 3.759534574784224*^9}, {
   3.7595346061708097`*^9, 3.7595346976317315`*^9}, {3.7595347397924843`*^9, 
   3.7595347919242167`*^9}, {3.759534837621271*^9, 3.7595348485959587`*^9}, 
   3.759534888190168*^9, {3.7601337174060235`*^9, 3.7601337244909544`*^9}, {
   3.760386570967065*^9, 3.7603866364408216`*^9}, {3.7603867832078447`*^9, 
   3.7603867969639874`*^9}, {3.7603868914558287`*^9, 3.760386893530814*^9}, {
   3.7603878758551064`*^9, 3.760387934507388*^9}, {3.7603883281530547`*^9, 
   3.760388332314151*^9}},ExpressionUUID->"047f239e-1554-4914-b83a-\
e6b0c0eeaad8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PioCorrection", "[", 
    RowBox[{"Xdata_", ",", "Nt_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "t", ",", "tempPi", ",", "tempIndex", ",",
        "lm"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempPi", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Xdata", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "t", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "Xdata", "]"}]}], "}"}]}], "]"}], "/", 
            RowBox[{"Nt", "[", 
             RowBox[{"[", "t", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1", ",", 
           RowBox[{"Length", "[", "Nt", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lm", " ", "=", " ", 
       RowBox[{"LinearModelFit", "[", 
        RowBox[{"tempPi", ",", "x", ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"lm", "[", "0", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7601309352134724`*^9, 3.7601311528722925`*^9}, {
  3.7601312459632034`*^9, 3.760131393149728*^9}, {3.7601337634635916`*^9, 
  3.7601337655533934`*^9}},ExpressionUUID->"24594722-732d-4b95-b50e-\
dd92e71d6e98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanFitCorrectionEst", "[", 
   RowBox[{"Xdata_", ",", "Nt_", ",", "PioListIn_", ",", "FitListIn_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "k", ",", "j", ",", "t", ",", "n", ",", "g", ",", "ks", ",", 
      "ps", ",", "fitCorrectL", ",", "pioCorr"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fitCorrectL", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ps", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], 
           RowBox[{"Length", "[", "Xdata", "]"}]], 
          RowBox[{
           RowBox[{"Xdata", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "t", "]"}], "]"}]}], 
         RowBox[{"Nt", "[", 
          RowBox[{"[", "t", "]"}], "]"}]], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ks", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"j", "=", "1"}], 
          RowBox[{"Length", "[", "Xdata", "]"}]], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"FitListIn", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "t"], "*", 
          RowBox[{"PioListIn", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fitCorrectL", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"ks", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"ps", "[", 
         RowBox[{"[", "1", "]"}], "]"}]], ")"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"fitCorrectL", "[", 
         RowBox[{"[", "t", "]"}], "]"}], " ", "=", 
        RowBox[{
         FractionBox[
          RowBox[{"ps", "[", 
           RowBox[{"[", 
            RowBox[{"t", "-", "1"}], "]"}], "]"}], 
          RowBox[{"ps", "[", 
           RowBox[{"[", "t", "]"}], "]"}]], "*", 
         FractionBox[
          RowBox[{"ks", "[", 
           RowBox[{"[", "t", "]"}], "]"}], 
          RowBox[{"ks", "[", 
           RowBox[{"[", 
            RowBox[{"t", "-", "1"}], "]"}], "]"}]]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2", ",", "4"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "fitCorrectL", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759784455410486*^9, 3.7597844875649996`*^9}, {
   3.759784646088828*^9, 3.7597846515676765`*^9}, {3.7597846958062353`*^9, 
   3.7597847112543507`*^9}, {3.7601306522951517`*^9, 
   3.7601307106189947`*^9}, {3.7601307465716743`*^9, 
   3.7601307911262693`*^9}, {3.7601314826541815`*^9, 3.760131540627887*^9}, {
   3.7601316367497845`*^9, 3.7601318164407*^9}, {3.760132125568824*^9, 
   3.7601321755905685`*^9}, 3.7601322240377874`*^9, {3.7601323523991547`*^9, 
   3.760132391927456*^9}, {3.760132766582183*^9, 3.760132767128868*^9}, {
   3.7601328893407393`*^9, 3.760132890076316*^9}, {3.7658164755456934`*^9, 
   3.7658164918914847`*^9}},ExpressionUUID->"09d856f6-95b9-4db0-9783-\
8de755282eaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitSeqFun", "[", 
   RowBox[{"PooledList_", ",", "MFCest_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "l", ",", "k", ",", "FitSeq", ",", "Temp"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FitSeq", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "PooledList", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Temp", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Temp", "[", 
            RowBox[{"[", "l", "]"}], "]"}], " ", "=", " ", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"PooledList", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "l"], 
            RowBox[{"ProdMeanFIT", "[", 
             RowBox[{"MFCest", ",", "l"}], "]"}]]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FitSeq", " ", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "=", "Temp"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "PooledList", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "FitSeq", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.759609401935941*^9, 3.759609889399588*^9}, {
  3.7596099318002033`*^9, 3.7596099323139086`*^9}, {3.7596100785338173`*^9, 
  3.7596100873097706`*^9}, {3.7596101670968857`*^9, 3.7596102073214536`*^9}, {
  3.759610245187677*^9, 
  3.759610255591693*^9}},ExpressionUUID->"0c697f74-6bfa-4f41-82f8-\
091b46df2bba"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Weight", "[", 
    RowBox[{"Sest_", ",", "Pest_", ",", "Nt_", ",", "MFCest_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Pest", " ", "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "/", "Sest"}], ")"}], "^", "2"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Nt", "[", 
          RowBox[{"[", "t", "]"}], "]"}], "*", 
         RowBox[{"Sest", "^", "t"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"ProdMeanFIT", "[", 
          RowBox[{"MFCest", ",", "t"}], "]"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.760388853157377*^9, 3.76038889216019*^9}, 
   3.7603909139945564`*^9, {3.760391336516024*^9, 
   3.7603913402823*^9}},ExpressionUUID->"12ffc908-6a23-47af-8d1b-\
366ecfa37571"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MassLogLike", "[", 
   RowBox[{"Sest_", ",", "Pest_", ",", "Xdata_", ",", "Nt_", ",", "MFCest_"}],
    "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"t", "=", "1"}], "4"], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], 
     RowBox[{"Length", "[", "Xdata", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Xdata", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"Pest", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            SuperscriptBox[
             RowBox[{"Sest", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "t"]}], 
           RowBox[{"ProdMeanFIT", "[", 
            RowBox[{"MFCest", ",", "t"}], "]"}]], "]"}], ")"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Nt", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", 
        RowBox[{"Pest", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"Sest", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "t"], 
         RowBox[{"ProdMeanFIT", "[", 
          RowBox[{"MFCest", ",", "t"}], "]"}]]}], ")"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7613307494336567`*^9, 3.7613307536032486`*^9}, {
  3.761330799056001*^9, 3.761330821177227*^9}, {3.7613308587795143`*^9, 
  3.761331148189126*^9}, {3.7613315480972013`*^9, 3.7613315526865416`*^9}, {
  3.761332033451932*^9, 
  3.7613320920251083`*^9}},ExpressionUUID->"b9d69861-2015-41b0-a935-\
26e8ed9e91ea"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"M", " ", "=", " ", "10"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7948562570853777`*^9, 
  3.794856260747545*^9}},ExpressionUUID->"1aef6349-96e5-415b-8339-\
1295d3cd21ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Function", " ", "for", " ", "iterative", " ", "estimates"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "n", ",", "k", ",", "m", ",", "pioNorm"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"XdataT", " ", "=", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Xdata", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "t", "]"}], "]"}], " ", "\[Equal]", " ", 
                  "0"}], ",", "1", ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "1", ",", "4"}], "}"}]}], "]"}], "<", "3"}],
             ",", 
            RowBox[{"Xdata", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "Nothing"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "[", "Xdata", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FitListIn", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "XdataT", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PioListIn", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "XdataT", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PooledList", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "XdataT", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"nit", " ", "=", " ", 
           RowBox[{"XdataT", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"fitEsts", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"\[Omega]", "/.", 
             RowBox[{"PolySolveFIT", "[", 
              RowBox[{"nit", ",", "Nt", ",", "MFCest"}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PooledList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"LikelihoodTuple", "[", 
            RowBox[{"fitEsts", ",", "nit", ",", "Nt", ",", "MFCest"}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "XdataT", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PioListIn", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PooledList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "PooledList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FitListIn", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PooledList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "PooledList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"West", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "FitListIn", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"West", "[", 
           RowBox[{"[", "z", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Weight", "[", 
           RowBox[{
            RowBox[{"FitListIn", "[", 
             RowBox[{"[", "z", "]"}], "]"}], ",", 
            RowBox[{"PioListIn", "[", 
             RowBox[{"[", "z", "]"}], "]"}], ",", "Nt", ",", "MFCest"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"z", ",", "1", ",", 
           RowBox[{"Length", "[", "FitListIn", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"West", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "30"}], "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pioNorm", " ", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"PioListIn", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "PioListIn", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"PioListIn", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"PioListIn", "/", "pioNorm"}], ")"}], "*", 
         RowBox[{"PioCorrection", "[", 
          RowBox[{"Xdata", ",", "Nt"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MassLogLike", "[", 
         RowBox[{
         "FitListIn", ",", "PioListIn", ",", "XdataT", ",", "Nt", ",", 
          "MFCest"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"MFCest", " ", "=", " ", 
        RowBox[{"MeanFitCorrectionEst", "[", 
         RowBox[{"XdataT", ",", "Nt", ",", "PioListIn", ",", "FitListIn"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "MFCest", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "M"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7595212121194525`*^9, 3.759521217240507*^9}, {
   3.75952125952419*^9, 3.7595212602018013`*^9}, {3.7595213750392756`*^9, 
   3.7595213757328663`*^9}, {3.7595215810136266`*^9, 
   3.7595216046208973`*^9}, {3.7595216412882113`*^9, 3.759521677460537*^9}, {
   3.7595220276151953`*^9, 3.7595221019427824`*^9}, {3.759522166594976*^9, 
   3.7595221831137033`*^9}, {3.759522217920397*^9, 3.7595222634694147`*^9}, {
   3.759522325034912*^9, 3.7595223685477495`*^9}, {3.759522441305773*^9, 
   3.7595224471694*^9}, {3.7595238647495193`*^9, 3.759523865898234*^9}, {
   3.759523943352434*^9, 3.759523987207153*^9}, {3.759524018866163*^9, 
   3.7595242073147993`*^9}, {3.7595244155827107`*^9, 
   3.7595245536899347`*^9}, {3.759524740908347*^9, 3.759524756396082*^9}, {
   3.7595248284086637`*^9, 3.7595248298408403`*^9}, {3.7595248694889145`*^9, 
   3.7595249901981707`*^9}, 3.759525141436762*^9, {3.759525172320549*^9, 
   3.7595252400215793`*^9}, {3.759525355633212*^9, 3.759525374665145*^9}, {
   3.7595255360478916`*^9, 3.7595255636030455`*^9}, 3.7595258258482904`*^9, {
   3.7595260349535036`*^9, 3.759526054857112*^9}, {3.759526195849335*^9, 
   3.759526328026929*^9}, {3.7595263762298913`*^9, 3.759526377996888*^9}, {
   3.7595264535002184`*^9, 3.759526514110516*^9}, {3.75952656505263*^9, 
   3.759526692605692*^9}, {3.7595267418156147`*^9, 3.7595267456963825`*^9}, {
   3.7595267862227554`*^9, 3.759526979303294*^9}, {3.7595270137724714`*^9, 
   3.7595270198270063`*^9}, {3.75952705281619*^9, 3.759527054453248*^9}, {
   3.7595271257279844`*^9, 3.759527225448609*^9}, {3.759527368460749*^9, 
   3.7595273768085213`*^9}, {3.759527691614994*^9, 3.759527697976342*^9}, {
   3.7595279728724613`*^9, 3.7595280199717236`*^9}, {3.759529657197689*^9, 
   3.7595297982606792`*^9}, {3.7595298554584227`*^9, 3.759529858396733*^9}, 
   3.759529893278879*^9, {3.759529929462*^9, 3.7595299307942333`*^9}, {
   3.759529970818181*^9, 3.7595299815590034`*^9}, {3.759530043917545*^9, 
   3.7595300480911446`*^9}, {3.75953012064511*^9, 3.759530134411194*^9}, {
   3.759530210505449*^9, 3.7595302143661056`*^9}, 3.759531028561658*^9, {
   3.7595311797682667`*^9, 3.759531181174458*^9}, {3.7595321019577417`*^9, 
   3.7595321029521694`*^9}, {3.759532141949974*^9, 3.7595321683757925`*^9}, {
   3.759532236445905*^9, 3.759532242415485*^9}, {3.759532328570632*^9, 
   3.7595323620691857`*^9}, {3.759533060518437*^9, 3.7595331217650833`*^9}, {
   3.7595338189689503`*^9, 3.759533855187158*^9}, {3.759533887915125*^9, 
   3.7595338975645747`*^9}, {3.7595339608905334`*^9, 
   3.7595339769672875`*^9}, {3.7595340713838563`*^9, 3.75953407262814*^9}, 
   3.7595341745546126`*^9, {3.7595342088500085`*^9, 3.759534251470677*^9}, {
   3.759534288441243*^9, 3.7595343995256968`*^9}, {3.7595351639524965`*^9, 
   3.7595352696404805`*^9}, {3.7595353158960257`*^9, 3.759535318095748*^9}, {
   3.7595353655114512`*^9, 3.7595353825256624`*^9}, {3.759535451860421*^9, 
   3.7595354573087606`*^9}, {3.7595355276733007`*^9, 
   3.7595355571866355`*^9}, {3.759608043825661*^9, 3.75960804742258*^9}, {
   3.7601319447066326`*^9, 3.7601320621042385`*^9}, {3.760132110116682*^9, 
   3.760132110509457*^9}, {3.760132245324584*^9, 3.76013229578765*^9}, {
   3.760132330862525*^9, 3.760132331205328*^9}, {3.760132452647459*^9, 
   3.7601324552839565`*^9}, {3.760132582678776*^9, 3.7601325840999594`*^9}, {
   3.7601326428612485`*^9, 3.7601326946174383`*^9}, {3.7601327815086093`*^9, 
   3.760132808180292*^9}, {3.7601331433094482`*^9, 3.7601333256669207`*^9}, {
   3.760133357231646*^9, 3.7601333609984827`*^9}, {3.760133413000657*^9, 
   3.7601334722756615`*^9}, {3.7601337869411287`*^9, 3.760133917388262*^9}, {
   3.760133976221465*^9, 3.7601340046431665`*^9}, {3.760390560658455*^9, 
   3.760390561075578*^9}, {3.760390593097437*^9, 3.7603906762955856`*^9}, {
   3.7603907082601366`*^9, 3.760390842987812*^9}, {3.760390962876758*^9, 
   3.7603909684333916`*^9}, {3.7603911104691687`*^9, 
   3.7603911105852194`*^9}, {3.760391350130951*^9, 3.76039136625292*^9}, {
   3.7603914641302843`*^9, 3.7603914947123957`*^9}, {3.7603922278716736`*^9, 
   3.7603922284893713`*^9}, {3.760392389710205*^9, 3.760392395165615*^9}, {
   3.760392569478952*^9, 3.7603925908055267`*^9}, 3.760393270737148*^9, {
   3.7613311822934318`*^9, 3.761331231907781*^9}, {3.7613314653409815`*^9, 
   3.7613314717582755`*^9}, {3.7613315692329874`*^9, 
   3.7613315699805555`*^9}, {3.7613316044376574`*^9, 3.76133162140786*^9}, 
   3.7613316791815114`*^9, 3.7613317096699057`*^9, 3.761331902132765*^9, {
   3.761334171012848*^9, 3.761334172136199*^9}, {3.7658164755613213`*^9, 
   3.7658164919227324`*^9}, {3.793985153566934*^9, 3.793985183376174*^9}, {
   3.794856250631651*^9, 
   3.794856251536229*^9}},ExpressionUUID->"0ee12138-2efe-47e3-a349-\
5392df6dbfc2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"checks", " ", "for", " ", "beneficial", " ", "peptides"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FitListIn", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", ">", " ", "1"}], ",", "1", ",", 
      "0"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "FitListIn", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.762286907768963*^9, 3.7622869943497267`*^9}, {
  3.7622870647329054`*^9, 3.762287126807697*^9}, {3.7658164755925694`*^9, 
  3.7658164755925694`*^9}, {3.793984520320836*^9, 3.793984528445108*^9}, {
  3.793984567045803*^9, 
  3.7939845926263647`*^9}},ExpressionUUID->"f25e530d-5a77-4d94-9f13-\
55b9f7940d55"],

Cell[BoxData["517"], "Output",
 CellChangeTimes->{{3.7622871126908407`*^9, 3.762287127716172*^9}, 
   3.7626308011067905`*^9, 
   3.7626350542332525`*^9},ExpressionUUID->"6a052a65-3a62-414f-8de4-\
018335a0f747"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7625424408330007`*^9, 3.762542460918421*^9}, 
   3.762542510766718*^9, {3.7625426026970186`*^9, 3.762542617858287*^9}, {
   3.762542663272134*^9, 3.7625427034949703`*^9}, 
   3.7625428276234865`*^9},ExpressionUUID->"675957f8-2387-4c41-9ab3-\
22652a8a36a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "sets", " ", "the", " ", "initial", " ", "Mean", " ", "Fitness", " ", 
     "Correction"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "current", " ", 
     "estimate", " ", "of", " ", "the", " ", "mean", " ", "fitness"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MFCInitEst", " ", "=", " ", "MFCest"}]}]], "Input",
 CellChangeTimes->{{3.761332165449708*^9, 3.7613321678253365`*^9}, {
  3.7658166488614483`*^9, 3.7658166641125913`*^9}, {3.793984607941422*^9, 
  3.793984679283547*^9}},ExpressionUUID->"2c0e54f1-e0d2-4143-b8f4-\
439085db7b85"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.38385097912530297`", ",", "0.7364864476535535`", ",", 
   "1.0815961716011888`", ",", "1.2368220151044556`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.761332169027645*^9, 3.7626308011317763`*^9, 3.7626350542602377`*^9, {
   3.7658166447362003`*^9, 3.7658166650345316`*^9}, 
   3.765820659233423*^9},ExpressionUUID->"b6b91549-65ad-4757-a35b-\
ea78ded2f9c8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cleaning", " ", "the", " ", "list", " ", "of", " ", "peptides"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DELPeptideIDList", " ", "=", " ", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Xdata", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "t", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
             ",", "1", ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1", ",", "4"}], "}"}]}], "]"}], "<", "3"}], 
        ",", 
        RowBox[{
         RowBox[{"PEPID", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "Nothing"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "[", "Xdata", "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.7613336040472393`*^9, 3.76133360839373*^9}, {
  3.7613336455003014`*^9, 3.7613337202211637`*^9}, {3.793984685403182*^9, 
  3.7939846978451457`*^9}},ExpressionUUID->"25aaec69-ffc8-4998-992e-\
2884692c86e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Creates", " ", "output", " ", "table", " ", "and", " ", "adjusts", " ", 
    "it", " ", "to", " ", "tsv", " ", "format"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"OutputTable", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DELPeptideIDList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"FitListIn", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"West", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "FitListIn", "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.7613337255830564`*^9, 3.7613338110477037`*^9}, 
   3.7613342233646164`*^9, 3.7625424898777437`*^9, 3.762542720528161*^9, {
   3.765816475608192*^9, 3.765816475608192*^9}, {3.7939847259948597`*^9, 
   3.7939847608785057`*^9}},ExpressionUUID->"6e3617d8-e64d-4446-bb28-\
cb27caf0254c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OutputTable", " ", "=", " ", 
   RowBox[{"Insert", "[", 
    RowBox[{"OutputTable", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PEP ID\>\"", ",", "\"\<FIT EST\>\"", ",", "\"\<WEIGHT\>\""}], 
      "}"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7613338831769934`*^9, 3.7613339521247215`*^9}, 
   3.7613339862371216`*^9},ExpressionUUID->"c0a6656b-d1ef-4a0b-926d-\
c74aa7211069"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<...\\\\MFCOutput.tsv\>\"", ",", "OutputTable", ",", "\"\<TSV\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7613339968170123`*^9, 3.7613340258692365`*^9}, {
  3.7613340640381947`*^9, 3.761334073680627*^9}, {3.795815576717515*^9, 
  3.795815577083112*^9}},ExpressionUUID->"bf79a8a0-4ba6-43ef-9f9d-\
a8defbf094da"]
},
WindowSize->{766, 772},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 364, 8, 30, "Input", "ExpressionUUID" -> \
"1cad163b-f300-4d46-a630-728ce220a535"],
Cell[925, 30, 1278, 33, 107, "Input", "ExpressionUUID" -> \
"de248237-a6b0-4314-b2d2-fc92d8efe3fb"],
Cell[2206, 65, 199, 4, 30, "Input", "ExpressionUUID" -> \
"f3a88a09-66cc-4b52-8d37-6a8fda17080d"],
Cell[2408, 71, 1135, 25, 107, "Input", "ExpressionUUID" -> \
"d0adb89c-15a0-4014-8a18-920a137812ed"],
Cell[CellGroupData[{
Cell[3568, 100, 206, 5, 30, "Input", "ExpressionUUID" -> \
"ca0cc706-fbc7-4a28-9886-3bafa14c19cd"],
Cell[3777, 107, 382, 8, 30, "Output", "ExpressionUUID" -> \
"b70423bd-a814-4097-8b7e-87eba345b929"]
}, Open  ]],
Cell[4174, 118, 1758, 47, 126, "Input", "ExpressionUUID" -> \
"31b0b418-f019-4381-8cf9-33c565c42f28"],
Cell[5935, 167, 546, 13, 82, "Input", "ExpressionUUID" -> \
"f7371659-3ca6-4b1b-9b00-87578c2bfd55"],
Cell[6484, 182, 1400, 33, 123, "Input", "ExpressionUUID" -> \
"ff661cdd-6307-4ca2-b230-d0fd0c600cc7"],
Cell[7887, 217, 808, 24, 82, "Input", "ExpressionUUID" -> \
"6a6d5593-9327-4a97-a42e-a7741b5e85df"],
Cell[8698, 243, 2387, 54, 296, "Input", "ExpressionUUID" -> \
"240659e6-ede1-4842-a498-a18153d1a4fb"],
Cell[11088, 299, 5838, 120, 443, "Input", "ExpressionUUID" -> \
"047f239e-1554-4914-b83a-e6b0c0eeaad8"],
Cell[16929, 421, 1735, 43, 183, "Input", "ExpressionUUID" -> \
"24594722-732d-4b95-b50e-dd92e71d6e98"],
Cell[18667, 466, 3759, 96, 437, "Input", "ExpressionUUID" -> \
"09d856f6-95b9-4db0-9783-8de755282eaa"],
Cell[22429, 564, 2359, 60, 353, "Input", "ExpressionUUID" -> \
"0c697f74-6bfa-4f41-82f8-091b46df2bba"],
Cell[24791, 626, 1001, 28, 69, "Input", "ExpressionUUID" -> \
"12ffc908-6a23-47af-8d1b-366ecfa37571"],
Cell[25795, 656, 1779, 49, 137, "Input", "ExpressionUUID" -> \
"b9d69861-2015-41b0-a935-26e8ed9e91ea"],
Cell[27577, 707, 243, 6, 50, "Input", "ExpressionUUID" -> \
"1aef6349-96e5-415b-8339-1295d3cd21ce"],
Cell[27823, 715, 11386, 226, 658, "Input", "ExpressionUUID" -> \
"0ee12138-2efe-47e3-a349-5392df6dbfc2"],
Cell[CellGroupData[{
Cell[39234, 945, 883, 21, 88, "Input", "ExpressionUUID" -> \
"f25e530d-5a77-4d94-9f13-55b9f7940d55"],
Cell[40120, 968, 211, 4, 30, "Output", "ExpressionUUID" -> \
"6a052a65-3a62-414f-8de4-018335a0f747"]
}, Open  ]],
Cell[40346, 975, 305, 5, 30, "Input", "ExpressionUUID" -> \
"675957f8-2387-4c41-9ab3-22652a8a36a9"],
Cell[CellGroupData[{
Cell[40676, 984, 653, 15, 69, "Input", "ExpressionUUID" -> \
"2c0e54f1-e0d2-4143-b8f4-439085db7b85"],
Cell[41332, 1001, 403, 9, 30, "Output", "ExpressionUUID" -> \
"b6b91549-65ad-4757-a35b-ea78ded2f9c8"]
}, Open  ]],
Cell[41750, 1013, 1370, 37, 88, "Input", "ExpressionUUID" -> \
"25aaec69-ffc8-4998-992e-2884692c86e8"],
Cell[43123, 1052, 1056, 27, 69, "Input", "ExpressionUUID" -> \
"6e3617d8-e64d-4446-bb28-cb27caf0254c"],
Cell[44182, 1081, 438, 11, 30, "Input", "ExpressionUUID" -> \
"c0a6656b-d1ef-4a0b-926d-c74aa7211069"],
Cell[44623, 1094, 372, 8, 30, "Input", "ExpressionUUID" -> \
"bf79a8a0-4ba6-43ef-9f9d-a8defbf094da"]
}
]
*)

